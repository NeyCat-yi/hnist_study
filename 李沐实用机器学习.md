# 李沐实用机器学习

## 数据获取

**网站**：

- Paperswithcodes Datasets
- Kaggle Datasets
- Google Dataset search
- Open Data on AWS
- paper with code

**融合数据**：

**数据增强**：

**生成数据**：例如gan模型

## 工具

openmmlab：所有模板都有，提供预训练模型，对比试验很容易

## 网页数据抓取

导入selenium库(华为源)：

```bash
pip install selenium -i https://mirrors.huaweicloud.com/repository/pypi/simple/
```

示例代码：

```python
from selenium import webdriver

chrome_options = webdriver.ChromeOptions() # 把参数拿出来
chrome_options.headless = True # 设置为不需要图形界面
chrome = webdriver.Chrome( # 新建一个浏览器实例
    options = chrome_options)

page = chrome.get(url) # 获取网页
```

## 数据标注

**自训练**：先标注一部分数据，训练一个比较复杂(只是辅助标注数据，不考虑计算成本以及上线)的模型，再去预测。得到预测后的标注，再调整一下标注后继续丢给模型训练

**找众包**：

**弱监督学习**：

## 探索性数据分析

 **导入数据分析和可视化常用的一些包**：

```python
# pip install seaborn pandas matplotlibe numpy matplotlib_inline
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt # 画图
import seaborn as sns # 画图
# 这两行把图片设成svg文件(svg可视化图片分辨率高)
import matplotlib_inline
matplotlib_inline.backend_inline.set_matplotlib_formats('svg')
```

**从网上爬的数据删掉一些没用的特征**：

```python
# data = pd.read_excel('data/data1.xlsx')
data = pd.read_csv('data/house_tiny.csv')
print(data.shape) # (4, 3) (多少个样本, 每个多少列)
print(data.head()) # 输出前面几行

null_sum = data.isnull().sum() # 能求出每一列有多少没数据

# 返回列名，null 小于总数据量的百分之30(假如列有十个数据，最多可以有三个null)
print(data.columns[null_sum < len(data) * 0.3]) 

# 找出哪些列的null大于等于百分之70 然后删掉 (inplace：在原数据里改变不需要额外内存)
# data.drop(columns=data.columns[null_sum > len(data) * 0.3], inplace=True) 
```

**处理数据**：

```python
# currency = ['Price']
# for c in currency: # 要处理的那些列
#     data[c] = data[c].replace(
#         r'[$,-]', '', regex=True).replace(
#         r'^\s*$', np.nan, regex=True).astype(float)
print(data.describe()) # 看数值类的数据 简单数据分析
```

```python
# 一个简单判别，找不正常数据 areas:列标签
# abnormal = (data[areas[1]] < 10) | (data[areas[1]] > 1e4) 

# data = data[~abnormal] # 不正常数据删掉
# sum(abnormal) # 查看不正常数据有多少
```

**画表图**：看分布状态

```python
# ax = sns.histplot(np.log10(data['Sold Price'])) # 数值差距太大，做个log10 可视化好看一点
# ax.set_xlim([3, 8])
# ax.set_xticks(range(3, 9))
# ax.set_xticklabels(['%.0e'%a for a in 10**ax.get_xticks])
```

后续：暂时在做视觉方向，数据分析以后再看https://www.bilibili.com/video/BV1Xh411p7M9?spm_id_from=333.788.player.switch&vd_source=adafa9c180e700fa0d1e7091bcaba4a9

## 数据清理

暂时在做视觉方向，数据分析以后再看https://www.bilibili.com/video/BV1kQ4y1Q7mx?spm_id_from=333.788.videopod.sections&vd_source=adafa9c180e700fa0d1e7091bcaba4a9

## 数据变换

**把数据改成模型可用的格式**：

暂时在做视觉方向，数据分析以后再看https://www.bilibili.com/video/BV1pQ4y167ej?spm_id_from=333.788.videopod.sections&vd_source=adafa9c180e700fa0d1e7091bcaba4a9

## 特征工程

用在大数据集上预训练过的模型来抽取特征(倒数第二层，例如即将送给softmax做分类的那一层)